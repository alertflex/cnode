<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:b="http://bootsfaces.net/ui"
                template="/WEB-INF/template.xhtml">

    <ui:define name="menu">  
        <style type="text/css">
            
            .navbar-default .navbar-brand:hover, .navbar-default .navbar-brand:focus {
                background: #eeeeee;
                color: #000;
            }

            .navbar-default .navbar-brand>li>a:hover, .navbar-default .navbar-brand>li>a:focus {
                background: #eeeeee;
                color: #000;
            }

            .navbar-default .navbar-nav>li>a:hover, .navbar-default .navbar-nav>li>a:focus {
                background: #eeeeee;
                color: #000;
            }

        </style>
        
        <b:navBar fixed="top" style="font-size: 18px;"  >
            <b:navbarLinks pull="left">
                <b:navLink value="Alerts" href="alerts.xhtml" > </b:navLink>
                <b:dropMenu value="IDS" >
                    <b:navLink value="configs" href="configs.xhtml" style="font-size: 16px;"></b:navLink>
                    <b:navLink value="filters" href="filters.xhtml" style="font-size: 16px;"></b:navLink>
                    <b:navLink value="rules" href="rules.xhtml" style="font-size: 16px;"></b:navLink>
                </b:dropMenu>
                <b:dropMenu value="Jobs" >
                    <b:navLink value="add" href="add_job.xhtml" style="font-size: 16px;"></b:navLink>
                    <b:navLink value="delete" href="delete_job.xhtml" style="font-size: 16px;"></b:navLink>
                    <b:navLink value="edit" href="edit_job.xhtml" style="font-size: 16px;"></b:navLink>
                </b:dropMenu>
                <b:navLink value="Settings" href="settings.xhtml" > </b:navLink>
            </b:navbarLinks>
            <b:navbarLinks pull="right">
                <b:navLink value="Sign out" href="signout.xhtml" > </b:navLink>
            </b:navbarLinks>
        </b:navBar>
        
    </ui:define>       
                 
                     
    <ui:define name="content" >
        <b:container >
            <b:form id="filters-file">
            <p:growl id="messages" showDetail="true" showSummary="true" autoUpdate="true"/>
                <b:panel title="IDS filter policies" collapsible="false" >
                    
                    <div class="EmptyBox10"></div>
                    
                    <b:buttonGroup style="width:50%; margin-bottom: 20px" >
                        <b:commandButton look="primary" value="Open" update="editDetail" actionListener="#{nodeFiltersController.initFilterFiles()}" oncomplete="PF('editDialog').show()" /> 
                        <b:commandButton look="primary" value="Save" update="saveDetail" actionListener="#{nodeFiltersController.initFilterFiles()}" oncomplete="PF('saveDialog').show()" /> 
                        <b:commandButton look="primary" value="Send" actionListener="#{nodeFiltersController.uploadFile()}" update=":filters-file:messages" />
                    </b:buttonGroup>
                    
                    <b:selectOneMenu id="node" value="#{nodeFiltersController.selectedNodeId}" style="width:50%" update=":filters-file">
                        <f:selectItem itemLabel="Select node" itemValue="" />
                        <f:selectItems value="#{nodeFiltersController.listNodeId}" />
                    </b:selectOneMenu>
                    
                    <p:dialog header="Select file" widgetVar="editDialog" modal="true" showEffect="fade" 
                              hideEffect="fade" resizable="false" closable="true" width="500px" >
                        
                        <b:panel id="editDetail" >
                            
                            <b:panelGrid columns="2" size="sm" >
                            
                                <b:selectOneMenu id="filter" value="#{nodeFiltersController.filterFile}" >
                                    <f:selectItem itemLabel="Select filter" itemValue="" />
                                    <f:selectItems value="#{nodeFiltersController.filterFiles}" />
                                </b:selectOneMenu>
                                
                                <b:commandButton look="primary" value="Submit" update=":filters-file" action="#{nodeFiltersController.openFile()}" onclick="PF('editDialog').hide();" />
                            </b:panelGrid>
                        </b:panel>
                    </p:dialog>
                                
                    <p:dialog header="Enter file name" widgetVar="saveDialog" modal="true" showEffect="fade"
                              hideEffect="fade" resizable="false" closable="true" width="500px">
                        
                        <b:panel id="saveDetail" >
                            
                            <b:panelGrid columns="2" size="sm" >
                                <b:inputText value="#{nodeFiltersController.newFile}"/>
                                <b:commandButton look="primary" value="Submit" update=":filters-file" action="#{nodeFiltersController.saveFile()}" onclick="PF('saveDialog').hide();" />
                            </b:panelGrid>
                                        
                        </b:panel>
                    </p:dialog>
                                
                                
                    <br/>
                    
                    <p:tabView>
                        <p:tab title="Collector">
                            
                            <p:panelGrid  columns="1" layout="grid" styleClass="ui-panelgrid-blank" style="width:50%">
					
                                <p:outputLabel value="Filter name:" />
                                <p:inputText value="#{nodeFiltersController.filterDesc}" />
                                                                    
                            </p:panelGrid>
                            
                        </p:tab>
                        
                        <p:tab title="CRS" >   
                                                
                            <br/>
                                                                    
                            <p:contextMenu for="crs" > 
                                <p:menuitem value="Create" update="crs" icon="fa fa-plus-circle" actionListener="#{nodeFiltersController.createSelectedCrsGl()}"/>
                                <p:menuitem value="Delete" update="crs" icon="fa fa-minus-circle" actionListener="#{nodeFiltersController.deleteSelectedCrsGl()}"/>  
                                <p:menuitem value="Edit" update="crsDetail" icon="fa fa-pencil" oncomplete="PF('crsDialog').show()"/>
                            </p:contextMenu> 
                        
                            <p:dataTable id="crs" value="#{nodeFiltersController.crsGl}" var="gl" rowKey="#{gl.id}"
                                 selection="#{nodeFiltersController.selectedCrsGl}" selectionMode="single" >
                        
                                <p:column headerText="Id">
                                    <h:outputText value="#{gl.id}" />
                                </p:column>
                        
                                <p:column headerText="Event">
                                    <h:outputText value="#{gl.event}" />
                                </p:column>
                                
                                <p:column headerText="Container">
                                    <h:outputText value="#{gl.host}" />
                                </p:column>
                                
                                <p:column headerText="Match">
                                    <h:outputText value="#{gl.match}" />
                                </p:column>
                                
                            </p:dataTable>
                        
                            <p:dialog header="Edit CRS gray list" widgetVar="crsDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" closable="false">
                                
                                <b:panel id="crsDetail" >
                                    
                                    <b:panelGrid colSpans="6,6">
                                        
                                        <b:row>
                                    
                                            <p:panelGrid  columns="1" layout="grid" styleClass="ui-panelgrid-blank" 
                                                rendered="#{not empty nodeFiltersController.selectedCrsGl}" style="width:50%">
                                    
                                                <p:outputLabel value="Event" />
                                                <p:inputText value="#{nodeFiltersController.selectedCrsGl.event}" />
                                        
                                                <p:outputLabel value="Container" />
                                                <p:inputText value="#{nodeFiltersController.selectedCrsGl.host}" />
                                                        
                                                <p:outputLabel value="Match" />
                                                <p:inputText value="#{nodeFiltersController.selectedCrsGl.match}" />
                                        
                                                <p:outputLabel value="Reproduced" />
                                                <p:inputText value="#{nodeFiltersController.selectedCrsGl.agr.reproduced}" />
                                                
                                                <p:outputLabel value="In period" />
                                                <p:inputText value="#{nodeFiltersController.selectedCrsGl.agr.inPeriod}" />
                                            </p:panelGrid>
                                            
                                        </b:row>
                                        
                                        <b:row>
                                                        
                                            <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank"
                                                rendered="#{not empty nodeFiltersController.selectedCrsGl}" style="width:50%"> 
                                        
                                                <p:outputLabel value="New event" />
                                                <p:inputText value="#{nodeFiltersController.selectedCrsGl.rsp.newEvent}" />
                                        
                                                <p:outputLabel value="Severity" />
                                                <p:inputText value="#{nodeFiltersController.selectedCrsGl.rsp.newSeverity}" />
                                                            
                                                <p:outputLabel value="Type" />
                                                <p:inputText value="#{nodeFiltersController.selectedCrsGl.rsp.newType}" />
                                                            
                                                <p:outputLabel value="Source" />
                                                <p:inputText value="#{nodeFiltersController.selectedCrsGl.rsp.newSource}" />
                                        
                                                <p:outputLabel value="Category" />
                                                <p:inputText value="#{nodeFiltersController.selectedCrsGl.rsp.newCategory}" />
                                        
                                                <p:outputLabel value="Description" />
                                                <p:inputText value="#{nodeFiltersController.selectedCrsGl.rsp.newDesc}" />
                                            </p:panelGrid>
                                    
                                        </b:row>
                                        
                                    </b:panelGrid>
                                    
                                    <p:panelGrid columns="2" layout="grid" styleClass="ui-panelgrid-blank"
                                        rendered="#{not empty nodeFiltersController.selectedCrsGl}" style="width:50%"> 
                                
                                        <p:commandButton value="Submit" update="crs" action="#{nodeFiltersController.updateSelectedCrsGl()}" onclick="PF('crsDialog').hide();" />
                                        <p:commandButton value="Cancel" update="crs" action="#{nodeFiltersController.cancelSelectedCrsGl()}" onclick="PF('crsDialog').hide();" />
                                            
                                    </p:panelGrid> 
                                                                        
                                </b:panel>
                            </p:dialog>
                        </p:tab>
                        
                        <p:tab title="HIDS" >   
                                                
                            <br/>
                                                                    
                            <p:contextMenu for="hids" > 
                                <p:menuitem value="Create" update="hids" icon="fa fa-plus-circle" actionListener="#{nodeFiltersController.createSelectedHidsGl()}"/>
                                <p:menuitem value="Delete" update="hids" icon="fa fa-minus-circle" actionListener="#{nodeFiltersController.deleteSelectedHidsGl()}"/>  
                                <p:menuitem value="Edit" update="hidsDetail" icon="fa fa-pencil" oncomplete="PF('hidsDialog').show()"/>
                            </p:contextMenu> 
                        
                            <p:dataTable id="hids" value="#{nodeFiltersController.hidsGl}" var="gl" rowKey="#{gl.id}"
                                 selection="#{nodeFiltersController.selectedHidsGl}" selectionMode="single" >
                        
                                <p:column headerText="Id">
                                    <h:outputText value="#{gl.id}" />
                                </p:column>
                        
                                <p:column headerText="Event">
                                    <h:outputText value="#{gl.event}" />
                                </p:column>
                                
                                <p:column headerText="Agent">
                                    <h:outputText value="#{gl.host}" />
                                </p:column>
                                
                                <p:column headerText="Match">
                                    <h:outputText value="#{gl.match}" />
                                </p:column>
                                
                            </p:dataTable>
                        
                            <p:dialog header="Edit HIDS gray list" widgetVar="hidsDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" closable="false">
                                
                                <b:panel id="hidsDetail" >
                                    
                                    <b:panelGrid colSpans="6,6">
                                        
                                        <b:row>
                                    
                                            <p:panelGrid  columns="1" layout="grid" styleClass="ui-panelgrid-blank" 
                                                rendered="#{not empty nodeFiltersController.selectedHidsGl}" style="width:50%">
                                    
                                                <p:outputLabel value="Event" />
                                                <p:inputText value="#{nodeFiltersController.selectedHidsGl.event}" />
                                        
                                                <p:outputLabel value="Container" />
                                                <p:inputText value="#{nodeFiltersController.selectedHidsGl.host}" />
                                                        
                                                <p:outputLabel value="Match" />
                                                <p:inputText value="#{nodeFiltersController.selectedHidsGl.match}" />
                                        
                                                <p:outputLabel value="Reproduced" />
                                                <p:inputText value="#{nodeFiltersController.selectedHidsGl.agr.reproduced}" />
                                                
                                                <p:outputLabel value="In period" />
                                                <p:inputText value="#{nodeFiltersController.selectedHidsGl.agr.inPeriod}" />
                                            </p:panelGrid>
                                            
                                        </b:row>
                                        
                                        <b:row>
                                                        
                                            <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank"
                                                rendered="#{not empty nodeFiltersController.selectedHidsGl}" style="width:50%"> 
                                        
                                                <p:outputLabel value="New event" />
                                                <p:inputText value="#{nodeFiltersController.selectedHidsGl.rsp.newEvent}" />
                                        
                                                <p:outputLabel value="Severity" />
                                                <p:inputText value="#{nodeFiltersController.selectedHidsGl.rsp.newSeverity}" />
                                                            
                                                <p:outputLabel value="Type" />
                                                <p:inputText value="#{nodeFiltersController.selectedHidsGl.rsp.newType}" />
                                                            
                                                <p:outputLabel value="Source" />
                                                <p:inputText value="#{nodeFiltersController.selectedHidsGl.rsp.newSource}" />
                                        
                                                <p:outputLabel value="Category" />
                                                <p:inputText value="#{nodeFiltersController.selectedHidsGl.rsp.newCategory}" />
                                        
                                                <p:outputLabel value="Description" />
                                                <p:inputText value="#{nodeFiltersController.selectedHidsGl.rsp.newDesc}" />
                                            </p:panelGrid>
                                    
                                        </b:row>
                                        
                                    </b:panelGrid>
                                    
                                    <p:panelGrid columns="2" layout="grid" styleClass="ui-panelgrid-blank"
                                        rendered="#{not empty nodeFiltersController.selectedHidsGl}" style="width:50%"> 
                                
                                        <p:commandButton value="Submit" update="hids" action="#{nodeFiltersController.updateSelectedHidsGl()}" onclick="PF('hidsDialog').hide();" />
                                        <p:commandButton value="Cancel" update="hids" action="#{nodeFiltersController.cancelSelectedHidsGl()}" onclick="PF('hidsDialog').hide();" />
                                            
                                    </p:panelGrid> 
                                                                        
                                </b:panel>
                            </p:dialog>
                        
                        </p:tab>
                        
                        <p:tab title="NIDS" >   
                                                
                            <br/>
                                                                    
                            <p:contextMenu for="nids" > 
                                <p:menuitem value="Create filter" update="nids" icon="fa fa-plus-circle" actionListener="#{nodeFiltersController.createSelectedNidsGl()}"/>
                                <p:menuitem value="Delete filter" update="nids" icon="fa fa-minus-circle" actionListener="#{nodeFiltersController.deleteSelectedNidsGl()}"/>  
                                <p:menuitem value="Edit filter" update="nidsDetail" icon="fa fa-pencil" oncomplete="PF('nidsDialog').show()"/>
                            </p:contextMenu> 
                        
                            <p:dataTable id="nids" value="#{nodeFiltersController.nidsGl}" var="gl" rowKey="#{gl.id}"
                                 selection="#{nodeFiltersController.selectedNidsGl}" selectionMode="single" >
                        
                                <p:column headerText="Id">
                                    <h:outputText value="#{gl.id}" />
                                </p:column>
                        
                                <p:column headerText="Event">
                                    <h:outputText value="#{gl.event}" />
                                </p:column>
                                
                                <p:column headerText="Host">
                                    <h:outputText value="#{gl.host}" />
                                </p:column>
                                
                                <p:column headerText="Match">
                                    <h:outputText value="#{gl.match}" />
                                </p:column>
                                
                            </p:dataTable>
                        
                            
                            <p:dialog header="Edit NIDS gray list" widgetVar="nidsDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" closable="false">
                                
                                <b:panel id="nidsDetail" >
                                    
                                    <b:panelGrid colSpans="6,6">
                                        
                                        <b:row>
                                    
                                            <p:panelGrid  columns="1" layout="grid" styleClass="ui-panelgrid-blank" 
                                                rendered="#{not empty nodeFiltersController.selectedNidsGl}" style="width:50%">
                                    
                                                <p:outputLabel value="Event" />
                                                <p:inputText value="#{nodeFiltersController.selectedNidsGl.event}" />
                                        
                                                <p:outputLabel value="Container" />
                                                <p:inputText value="#{nodeFiltersController.selectedNidsGl.host}" />
                                                        
                                                <p:outputLabel value="Match" />
                                                <p:inputText value="#{nodeFiltersController.selectedNidsGl.match}" />
                                        
                                                <p:outputLabel value="Reproduced" />
                                                <p:inputText value="#{nodeFiltersController.selectedNidsGl.agr.reproduced}" />
                                                
                                                <p:outputLabel value="In period" />
                                                <p:inputText value="#{nodeFiltersController.selectedNidsGl.agr.inPeriod}" />
                                            </p:panelGrid>
                                            
                                        </b:row>
                                        
                                        <b:row>
                                                        
                                            <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank"
                                                rendered="#{not empty nodeFiltersController.selectedNidsGl}" style="width:50%"> 
                                        
                                                <p:outputLabel value="New event" />
                                                <p:inputText value="#{nodeFiltersController.selectedNidsGl.rsp.newEvent}" />
                                        
                                                <p:outputLabel value="Severity" />
                                                <p:inputText value="#{nodeFiltersController.selectedNidsGl.rsp.newSeverity}" />
                                                            
                                                <p:outputLabel value="Type" />
                                                <p:inputText value="#{nodeFiltersController.selectedNidsGl.rsp.newType}" />
                                                            
                                                <p:outputLabel value="Source" />
                                                <p:inputText value="#{nodeFiltersController.selectedNidsGl.rsp.newSource}" />
                                        
                                                <p:outputLabel value="Category" />
                                                <p:inputText value="#{nodeFiltersController.selectedNidsGl.rsp.newCategory}" />
                                        
                                                <p:outputLabel value="Description" />
                                                <p:inputText value="#{nodeFiltersController.selectedNidsGl.rsp.newDesc}" />
                                            </p:panelGrid>
                                    
                                        </b:row>
                                        
                                    </b:panelGrid>
                                    
                                    <p:panelGrid columns="2" layout="grid" styleClass="ui-panelgrid-blank"
                                        rendered="#{not empty nodeFiltersController.selectedNidsGl}" style="width:50%"> 
                                
                                        <p:commandButton value="Submit" update="nids" action="#{nodeFiltersController.updateSelectedNidsGl()}" onclick="PF('nidsDialog').hide();" />
                                        <p:commandButton value="Cancel" update="nids" action="#{nodeFiltersController.cancelSelectedNidsGl()}" onclick="PF('nidsDialog').hide();" />
                                            
                                    </p:panelGrid> 
                                                                        
                                </b:panel>
                            </p:dialog>
                        </p:tab>
                        
                        <p:tab title="WAF" >
                                                
                            <br/>
                                                                    
                            <p:contextMenu for="waf" > 
                                <p:menuitem value="Create filter" update="waf" icon="fa fa-plus-circle" actionListener="#{nodeFiltersController.createSelectedWafGl()}"/>
                                <p:menuitem value="Delete filter" update="waf" icon="fa fa-minus-circle" actionListener="#{nodeFiltersController.deleteSelectedWafGl()}"/>  
                                <p:menuitem value="Edit filter" update="wafDetail" icon="fa fa-pencil" oncomplete="PF('wafDialog').show()"/>
                            </p:contextMenu> 
                        
                            <p:dataTable id="waf" value="#{nodeFiltersController.wafGl}" var="gl" rowKey="#{gl.id}"
                                 selection="#{nodeFiltersController.selectedWafGl}" selectionMode="single" >
                        
                                <p:column headerText="Id">
                                    <h:outputText value="#{gl.id}" />
                                </p:column>
                        
                                <p:column headerText="Event">
                                    <h:outputText value="#{gl.event}" />
                                </p:column>
                                
                                <p:column headerText="Host">
                                    <h:outputText value="#{gl.host}" />
                                </p:column>
                                
                                <p:column headerText="Match">
                                    <h:outputText value="#{gl.match}" />
                                </p:column>
                                
                            </p:dataTable>
                        
                            <p:dialog header="Edit WAF gray list" widgetVar="wafDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" closable="false">
                                
                                <b:panel id="wafDetail" >
                                    
                                    <b:panelGrid colSpans="6,6">
                                        
                                        <b:row>
                                    
                                            <p:panelGrid  columns="1" layout="grid" styleClass="ui-panelgrid-blank" 
                                                rendered="#{not empty nodeFiltersController.selectedWafGl}" style="width:50%">
                                    
                                                <p:outputLabel value="Event" />
                                                <p:inputText value="#{nodeFiltersController.selectedWafGl.event}" />
                                        
                                                <p:outputLabel value="Container" />
                                                <p:inputText value="#{nodeFiltersController.selectedWafGl.host}" />
                                                        
                                                <p:outputLabel value="Match" />
                                                <p:inputText value="#{nodeFiltersController.selectedWafGl.match}" />
                                        
                                                <p:outputLabel value="Reproduced" />
                                                <p:inputText value="#{nodeFiltersController.selectedWafGl.agr.reproduced}" />
                                                
                                                <p:outputLabel value="In period" />
                                                <p:inputText value="#{nodeFiltersController.selectedWafGl.agr.inPeriod}" />
                                            </p:panelGrid>
                                            
                                        </b:row>
                                        
                                        <b:row>
                                                        
                                            <p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank"
                                                rendered="#{not empty nodeFiltersController.selectedWafGl}" style="width:50%"> 
                                        
                                                <p:outputLabel value="New event" />
                                                <p:inputText value="#{nodeFiltersController.selectedWafGl.rsp.newEvent}" />
                                        
                                                <p:outputLabel value="Severity" />
                                                <p:inputText value="#{nodeFiltersController.selectedWafGl.rsp.newSeverity}" />
                                                            
                                                <p:outputLabel value="Type" />
                                                <p:inputText value="#{nodeFiltersController.selectedWafGl.rsp.newType}" />
                                                            
                                                <p:outputLabel value="Source" />
                                                <p:inputText value="#{nodeFiltersController.selectedWafGl.rsp.newSource}" />
                                        
                                                <p:outputLabel value="Category" />
                                                <p:inputText value="#{nodeFiltersController.selectedWafGl.rsp.newCategory}" />
                                        
                                                <p:outputLabel value="Description" />
                                                <p:inputText value="#{nodeFiltersController.selectedWafGl.rsp.newDesc}" />
                                            </p:panelGrid>
                                    
                                        </b:row>
                                        
                                    </b:panelGrid>
                                    
                                    <p:panelGrid columns="2" layout="grid" styleClass="ui-panelgrid-blank"
                                        rendered="#{not empty nodeFiltersController.selectedWafGl}" style="width:50%"> 
                                
                                        <p:commandButton value="Submit" update="waf" action="#{nodeFiltersController.updateSelectedWafGl()}" onclick="PF('wafDialog').hide();" />
                                        <p:commandButton value="Cancel" update="waf" action="#{nodeFiltersController.cancelSelectedWafGl()}" onclick="PF('wafDialog').hide();" />
                                            
                                    </p:panelGrid> 
                                                                        
                                </b:panel>
                            </p:dialog>
                          
                        </p:tab>
                    </p:tabView>
                </b:panel>
                
            </b:form>
        </b:container > 
    </ui:define>

</ui:composition>