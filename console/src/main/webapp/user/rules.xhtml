<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:b="http://bootsfaces.net/ui"
                template="/WEB-INF/template.xhtml">

    <ui:define name="menu">  
        <style type="text/css">
            
            .navbar-default .navbar-brand:hover, .navbar-default .navbar-brand:focus {
                background: #eeeeee;
                color: #000;
            }

            .navbar-default .navbar-brand>li>a:hover, .navbar-default .navbar-brand>li>a:focus {
                background: #eeeeee;
                color: #000;
            }

            .navbar-default .navbar-nav>li>a:hover, .navbar-default .navbar-nav>li>a:focus {
                background: #eeeeee;
                color: #000;
            }

        </style>
        
        <b:navBar fixed="top" style="font-size: 18px;"  >
            <b:navbarLinks pull="left">
                <b:navLink value="Alerts" href="alerts.xhtml" > </b:navLink>
                <b:dropMenu value="IDS" >
                    <b:navLink value="configs" href="configs.xhtml" style="font-size: 16px;"></b:navLink>
                    <b:navLink value="filters" href="filters.xhtml" style="font-size: 16px;"></b:navLink>
                    <b:navLink value="rules" href="rules.xhtml" style="font-size: 16px;"></b:navLink>
                </b:dropMenu>
                <b:dropMenu value="Jobs" >
                    <b:navLink value="add" href="add_job.xhtml" style="font-size: 16px;"></b:navLink>
                    <b:navLink value="delete" href="delete_job.xhtml" style="font-size: 16px;"></b:navLink>
                    <b:navLink value="edit" href="edit_job.xhtml" style="font-size: 16px;"></b:navLink>
                </b:dropMenu>
                <b:navLink value="Settings" href="settings.xhtml" > </b:navLink>
            </b:navbarLinks>
            <b:navbarLinks pull="right">
                <b:navLink value="Sign out" href="signout.xhtml" > </b:navLink>
            </b:navbarLinks>
        </b:navBar>
        
    </ui:define>       
                 
                     
    <ui:define name="content" >
        <b:container >
            <b:form id="sensor_rules">
            <p:growl id="messages" showDetail="true" showSummary="true" autoUpdate="true"/>
                <b:panel title="IDS rules" collapsible="false" >
                    
                    <div class="EmptyBox10"></div>
                    
                    <b:buttonGroup style="width:50%; margin-bottom: 20px" >
                        <b:commandButton look="primary" value="Open" update="editRule" actionListener="#{sensorRulesController.initListRules()}" oncomplete="PF('editDialog').show()" /> 
                        <b:commandButton look="primary" value="Save" update=":sensor_rules" actionListener="#{sensorRulesController.saveRule()}" /> 
                        <b:commandButton look="primary" value="Send" update=":sensor_rules" actionListener="#{sensorRulesController.sendRule()}" />
                    </b:buttonGroup>
                    
                    <div class="EmptyBox10"></div>
                    
                    <b:selectOneMenu id="node" value="#{sensorRulesController.selectedNodeId}" style="width:50%" update="sensor">
                            <f:selectItem itemLabel="Select node" itemValue="" />
                            <f:selectItems value="#{sensorRulesController.listNodeId}" />
                            <f:ajax event="change" listener="#{sensorRulesController.updateListSensorNames()}" />
                    </b:selectOneMenu>
                    
                    <div class="EmptyBox10"></div>   
                    
                    <b:selectOneMenu id="sensor" value="#{sensorRulesController.selectedSensor}" style="width:50%" >
                        <f:selectItem itemLabel="Select sensor" itemValue="" />
                        <f:selectItems value="#{sensorRulesController.listSensor}" />
                    </b:selectOneMenu>
                    
                    <h:panelGrid columns="2"  >
                        <p:selectBooleanCheckbox value="#{sensorRulesController.fileType}" />
                        <p:outputLabel value="Decoder (only for HIDS)" style="font-weight: normal; margin-left: 10px"/>
                    </h:panelGrid>    
                    
                    <b:inputTextarea  value="#{sensorRulesController.rulePayload}"/>
                    
                    <p:outputLabel value="Select file to upload" style="font-weight: normal;"/>
                    <p:fileUpload fileUploadListener="#{sensorRulesController.uploadRule}" dragDropSupport="false"
                        sizeLimit="100000000" fileLimit="1" update=":sensor_rules" style="font-weight: normal;" />
                            
                    <p:dialog header="Select rule" widgetVar="editDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" closable="true">
                        
                        <b:panel id="editRule" >
                            <b:panelGrid columns="2" size="sm" >
                                 <b:selectOneMenu value="#{sensorRulesController.selectedRule}" >
                                    <f:selectItem itemLabel="Select rule: " itemValue="#{sensorRulesController.selectedRule}" />
                                    <f:selectItems value="#{sensorRulesController.listRules}" />
                                </b:selectOneMenu>
                                
                                <b:commandButton look="primary"  value="Submit" update=":sensor_rules" action="#{sensorRulesController.openRule()}" onclick="PF('editDialog').hide();" />
                            </b:panelGrid>
                        </b:panel>
                    </p:dialog>
                    
                </b:panel>
             </b:form>
        </b:container> 
    </ui:define>

</ui:composition>